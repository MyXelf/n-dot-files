# tmux.conf file
#
# Author: Nelson R Monserrate <nrmonserrate@gmail.com>

# ----------------------------------------------------------------------------------------------------------------------
#  Global Configuration
# ----------------------------------------------------------------------------------------------------------------------

# Change prefix to C-a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Edit the conf file
bind E new-window -n 'tmux' 'vim ~/.tmux.conf && tmux source ~/.tmux.conf && tmux display "~/.tmux.conf sourced"'

# Source the conf file
bind S source-file ~/.tmux.conf \; display "~/.tmux.conf sourced"

# History
set -g history-limit 10000
# bind C-l clear-history

# Generate xterm -style function key sequences (def is off)
setw -g xterm-keys on

# Define default terminal & shell
set -g default-terminal "screen-256color"
set -g default-shell "/bin/bash"

# Disable various mesages
set -s quiet on

# Display message
bind M display-message

# ----------------------------------------------------------------------------------------------------------------------
#  Windows & Panes
# ----------------------------------------------------------------------------------------------------------------------

# Create new window
bind c command-prompt -p "New-window:" "new-window -n %% -c ~/"
bind C command-prompt -p "New-window:" "new-window -a -n %% -c ~/"

# Split window into panes
bind s split-window -v -c ~/
bind v split-window -h -c ~/

# Start window index of 1 (not a good idea)
# set -g base-index 1
# setw -g pane-base-index 1

# Sync panes
bind = set synchronize-panes on
bind \ set synchronize-panes off

# Rename window
bind r command-prompt -p "Rename-window:" "rename-window %%"

# Set window notifications
setw -g monitor-activity on
set -g visual-activity on

# Renumber windows always
set -g renumber-windows on

# ----------------------------------------------------------------------------------------------------------------------
#  Navigation :: Resizing
# ----------------------------------------------------------------------------------------------------------------------

# Set wait-off so vim can work again (this is cool)
set -sg escape-time 0

# Increase repeat time
set -sg repeat-time 600

# Navigate between windows
bind -r . next-window
bind -r , previous-window
bind / last-window

# Navigate between panes
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Pane resizing
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# Toggle zoom pane zoom
bind z resize-pane -Z

# Swap panes
bind > swap-pane -D
bind < swap-pane -U

# Mouse support (not a good idea)
# setw -g mode-mouse on
# set -g mouse-select-pane on
# set -g mouse-resize-pane on
# set -g mouse-select-window on

# ----------------------------------------------------------------------------------------------------------------------
#  Visual/Copy/Paste Mode :: Ve Improved
# ----------------------------------------------------------------------------------------------------------------------

# Copy mode | buffer
bind Enter copy-mode
bind b list-buffers
bind p paste-buffer
bind P choose-buffer

# Ve Improved
set -g status-keys vi
setw -g mode-keys vi
bind -t vi-copy v begin-selection
bind -t vi-copy V rectangle-toggle
bind -t vi-copy y copy-selection
bind -t vi-copy Escape cancel
bind -t vi-copy H start-of-line
bind -t vi-copy L end-of-line

# ----------------------------------------------------------------------------------------------------------------------
#  Colors & Themes
# ----------------------------------------------------------------------------------------------------------------------

# Windows mode color
setw -g mode-fg black
setw -g mode-bg white
setw -g mode-attr dim

# Pane border color
set -g pane-border-fg colour237
set -g pane-border-bg colour233
set -g pane-active-border-fg colour237
set -g pane-active-border-bg colour233

# ----------------------------------------------------------------------------------------------------------------------
#  User Defined Conf Files
# ----------------------------------------------------------------------------------------------------------------------

if '[ -f  ~/.tmux/bar.conf ]' 'source-file ~/.tmux/bar.conf'
if '[ -f ~/.tmux/local/gateway.conf ]' 'source-file ~/.tmux/local/gateway.conf'

# ----------------------------------------------------------------------------------------------------------------------
#  Melange
# ----------------------------------------------------------------------------------------------------------------------

# 24 hour clock
setw -g clock-mode-style 24

# Open man page of ??
bind m command-prompt -p "Open man page for:" "split-window -h 'exec man %%'"

# Environment
set -g update-environment "DISPLAY SSH_ASKPASS SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION WINDOWID XAUTHORITY"
